### 📄 Archivo 1: F-05_QR_Asamblea
```mermaid
sequenceDiagram
    participant Admin as Administrador
    participant GS as Governance Service
    participant IS as Identity Service
    participant CS as Compliance Service
    participant WORM as WORM Logs
    participant Usuario as Usuario Final
    participant App as Aplicación Móvil/Web
    participant GW as API Gateway

    Admin->>GS: POST /governance/events (crear asamblea)
    GS->>CS: Valida legalidad y políticas activas
    CS-->>GS: Políticas válidas
    GS->>IS: Solicita generación de QR de acceso
    IS->>IS: Firma COSE/JWS con TTL ≤ 300s
    IS->>WORM: Registra emisión del QR
    IS-->>GS: QR generado
    GS-->>Admin: QR disponible para escaneo

    Usuario->>App: Escanea QR con lector móvil/web
    App->>GW: POST /validate (envía QR escaneado)
    GW->>IS: Verifica firma y TTL
    IS->>GS: Consulta evento y estado
    GS->>CS: Valida elegibilidad del usuario
    CS-->>GS: Usuario válido
    GS->>WORM: Registra asistencia en quórum
    GS-->>GW: Acceso autorizado
    GW-->>App: Confirmación de ingreso

    note over GS: Al finalizar la asamblea\n el QR se desactiva automáticamente
```
# Artefactos Técnicos — F-05: QR de Asamblea

## 🧩 Endpoints OpenAPI
- `POST /governance/events/{id}/qr` → Genera QR legal por evento
- `POST /validate` → Valida QR escaneado y registra asistencia

## 🔐 Especificación COSE/JWS
- Claims: `event_id`, `tenant_id`, `condominium_id`, `issued_at`, `expires_at`, `kid`
- Firma: ES256 (clave rotativa)
- TTL: ≤ 300 segundos

## 📊 Métricas
- `qr_generation_latency_p95 ≤ 500ms`
- `qr_validation_error_rate`
- `attendance_registered_total`

## 📦 Evento Kafka
- `AttendanceRegistered.v1`
  - Payload: `{ event_id, user_id, timestamp, policy_version }`
  - Topic: `governance.attendance`
  - Schema: registrado en Schema Registry

## 📁 Registro Legal
- WORM + hash-chain
- Firma verificable
- Trazabilidad completa

## ✅ Convenciones Aplicadas
- Privacy by Design (sin datos personales en QR)
- Zero Trust (validación contextual)
- Fail-closed ante expiración o firma inválida
- JWT/COSE conforme a RFC 8392, RFC 9052
