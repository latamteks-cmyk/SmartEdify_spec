### ğŸ“„ Archivo 1: F-05_QR_Asamblea
```mermaid
sequenceDiagram
    participant Admin as Administrador
    participant GS as Governance Service
    participant IS as Identity Service
    participant CS as Compliance Service
    participant WORM as WORM Logs
    participant Usuario as Usuario Final
    participant App as AplicaciÃ³n MÃ³vil/Web
    participant GW as API Gateway

    Admin->>GS: POST /governance/events (crear asamblea)
    GS->>CS: Valida legalidad y polÃ­ticas activas
    CS-->>GS: PolÃ­ticas vÃ¡lidas
    GS->>IS: Solicita generaciÃ³n de QR de acceso
    IS->>IS: Firma COSE/JWS con TTL â‰¤ 300s
    IS->>WORM: Registra emisiÃ³n del QR
    IS-->>GS: QR generado
    GS-->>Admin: QR disponible para escaneo

    Usuario->>App: Escanea QR con lector mÃ³vil/web
    App->>GW: POST /validate (envÃ­a QR escaneado)
    GW->>IS: Verifica firma y TTL
    IS->>GS: Consulta evento y estado
    GS->>CS: Valida elegibilidad del usuario
    CS-->>GS: Usuario vÃ¡lido
    GS->>WORM: Registra asistencia en quÃ³rum
    GS-->>GW: Acceso autorizado
    GW-->>App: ConfirmaciÃ³n de ingreso

    note over GS: Al finalizar la asamblea\n el QR se desactiva automÃ¡ticamente
```
# Artefactos TÃ©cnicos â€” F-05: QR de Asamblea

## ğŸ§© Endpoints OpenAPI
- `POST /governance/events/{id}/qr` â†’ Genera QR legal por evento
- `POST /validate` â†’ Valida QR escaneado y registra asistencia

## ğŸ” EspecificaciÃ³n COSE/JWS
- Claims: `event_id`, `tenant_id`, `condominium_id`, `issued_at`, `expires_at`, `kid`
- Firma: ES256 (clave rotativa)
- TTL: â‰¤ 300 segundos

## ğŸ“Š MÃ©tricas
- `qr_generation_latency_p95 â‰¤ 500ms`
- `qr_validation_error_rate`
- `attendance_registered_total`

## ğŸ“¦ Evento Kafka
- `AttendanceRegistered.v1`
  - Payload: `{ event_id, user_id, timestamp, policy_version }`
  - Topic: `governance.attendance`
  - Schema: registrado en Schema Registry

## ğŸ“ Registro Legal
- WORM + hash-chain
- Firma verificable
- Trazabilidad completa

## âœ… Convenciones Aplicadas
- Privacy by Design (sin datos personales en QR)
- Zero Trust (validaciÃ³n contextual)
- Fail-closed ante expiraciÃ³n o firma invÃ¡lida
- JWT/COSE conforme a RFC 8392, RFC 9052
